---
import Base from "../layouts/base.astro";
import { getCollection } from "astro:content";

const stores = await getCollection("stores");
const offers = await getCollection("offers");
const guides = await getCollection("guides");

const topStores = [...stores].slice(0, 3);
const topOffers = [...offers].slice(0, 3);
const topGuides = [...guides].slice(0, 3);

const baseUrl = import.meta.env.BASE_URL;
const go = (p) => `${baseUrl}${String(p).replace(/^\/+/, "")}`;
---

<Base title="Beanfreaks — Health. Wellness. Organic.">
  <section class="bf-card bf-card-pad">
    <div class="bf-grid">
      <div class="md:col-span-7">
        <div class="bf-kicker">Your local health food store in Cardiff</div>
        <h1 class="bf-h1 mt-3">Health. Wellness. Organic.</h1>
        <p class="mt-4 text-slate-800 leading-relaxed">
          Find your nearest branch and discover organic, eco-friendly and local produce —
          a one-stop shop for healthier living.
        </p>

        <div class="mt-6 flex flex-wrap gap-3">
          <a class="bf-btn-primary" href={go("/stores/")}>Find a store</a>
          <a class="bf-btn-ghost" href={go("/offers/")}>Deals & events</a>
        </div>

        <div class="mt-6 flex flex-wrap gap-2">
          <span class="bf-chip">Organic</span>
          <span class="bf-chip">Snacks</span>
          <span class="bf-chip">Local</span>
          <span class="bf-chip">Health</span>
          <span class="bf-chip">Vegan</span>
          <span class="bf-chip">Advice</span>
        </div>
      </div>

      <div class="md:col-span-5">
        <div class="rounded-2xl border border-slate-200 bg-oat/40 p-6">
          <div class="bf-kicker">Quick links</div>
          <ul class="mt-3 space-y-2 text-slate-800">
            <li><a href={go("/guides/")}>Guides</a></li>
            <li><a href={go("/offers/")}>Offers</a></li>
            <li><a href={go("/contact/")}>Contact</a></li>
          </ul>
          <div class="mt-5 text-xs text-slate-600">
            Est. 1978 • Family-run • Cardiff
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="mt-10">
    <div class="flex items-end justify-between gap-6">
      <h2 class="bf-h2">Find your nearest branch</h2>
      <a class="text-sm" href={go("/stores/")}>View all</a>
    </div>

    <div class="mt-6 grid gap-6 md:grid-cols-3">
      {topStores.map((s) => (
        <a class="bf-card bf-card-pad no-underline hover:-translate-y-0.5 transition" href={go(`/stores/${s.slug}/`)}>
          <div class="bf-kicker">Store</div>
          <div class="mt-2 text-xl font-semibold">{s.data?.title ?? s.slug}</div>
          <p class="mt-3 text-slate-700 text-sm leading-relaxed">
            {s.data?.summary ?? "Opening hours, contact details, and where to find us."}
          </p>
          <div class="mt-4 text-sm font-semibold text-leaf">Open details →</div>
        </a>
      ))}
    </div>
  </section>

  <section class="mt-10">
    <div class="flex items-end justify-between gap-6">
      <h2 class="bf-h2">Deals & events</h2>
      <a class="text-sm" href={go("/offers/")}>View all</a>
    </div>

    <div class="mt-6 grid gap-6 md:grid-cols-3">
      {topOffers.map((o) => (
        <a class="bf-card bf-card-pad no-underline hover:-translate-y-0.5 transition" href={go(`/offers/${o.slug}/`)}>
          <div class="bf-kicker">Offer</div>
          <div class="mt-2 text-lg font-semibold">{o.data?.title ?? o.slug}</div>
          <p class="mt-3 text-slate-700 text-sm leading-relaxed">
            {o.data?.summary ?? "Offers and promotions coming up in your local health food store."}
          </p>
          <div class="mt-4 text-sm font-semibold text-leaf">Read more →</div>
        </a>
      ))}
    </div>
  </section>

  <section class="mt-10">
    <div class="flex items-end justify-between gap-6">
      <h2 class="bf-h2">Guides</h2>
      <a class="text-sm" href={go("/guides/")}>View all</a>
    </div>

    <div class="mt-6 grid gap-6 md:grid-cols-3">
      {topGuides.map((g) => (
        <a class="bf-card bf-card-pad no-underline hover:-translate-y-0.5 transition" href={go(`/guides/${g.slug}/`)}>
          <div class="bf-kicker">Guide</div>
          <div class="mt-2 text-lg font-semibold">{g.data?.title ?? g.slug}</div>
          <p class="mt-3 text-slate-700 text-sm leading-relaxed">
            {g.data?.summary ?? "Simple, practical advice — no jargon, no lectures."}
          </p>
          <div class="mt-4 text-sm font-semibold text-leaf">Open →</div>
        </a>
      ))}
    </div>
  </section>
</Base>
